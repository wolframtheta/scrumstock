"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3315],{3315:(S,v,s)=>{s.d(v,{E:()=>F});var l=s(5861),u=s(6895),t=s(8256),C=s(433),f=s(9993),r=s(6114);let I=(()=>{class i{constructor(){}itemDTOToSalesItemDTO(e,n){var o;return{id:e.id,name:e.name,quantity:e.quantity,quantityAdded:null!==(o=null==n?void 0:n.quantityAdded)&&void 0!==o?o:0,isAdded:!!n,price:e.price}}itemSizeToSalesItemDTO(e,n,o){var a;return{id:e.id,name:n.name,quantity:e.quantity,quantityAdded:null!==(a=null==o?void 0:o.quantityAdded)&&void 0!==a?a:0,isAdded:!!o,price:n.price,size:e.name,idFather:n.id}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var d=s(910);function g(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addItem(o))}),t._uU(1,"A\xf1adir"),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("disabled",!e.quantity||e.quantityAdded>e.quantity)}}function b(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-buttons",9)(1,"ion-button",10),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.removeItem(o))}),t._UZ(2,"ion-icon",11),t.qZA(),t.TgZ(3,"ion-label"),t._uU(4),t.qZA(),t.TgZ(5,"ion-button",8),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addItem(o))}),t._UZ(6,"ion-icon",12),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.quantityAdded),t.xp6(1),t.Q6J("disabled",e.quantityAdded>=e.quantity)}}function x(i,c){if(1&i&&(t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.qZA(),t.YNc(3,g,2,1,"ion-button",6),t.YNc(4,b,7,2,"ion-buttons",7),t.qZA()),2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e.size),t.xp6(1),t.Q6J("ngIf",!e.quantityAdded),t.xp6(1),t.Q6J("ngIf",null==e?null:e.quantityAdded)}}let q=(()=>{class i{constructor(e,n,o){this.modalCtrl=e,this.mapperService=n,this.cartService=o,this.sizeItems=[]}ngOnInit(){this.loadModal()}loadModal(){var e=this;return(0,l.Z)(function*(){e.cart=yield e.cartService.initCart();const n=yield e.cartService.getGeneralCart();e.item.sizes&&(e.sizeItems=e.item.sizes.map(o=>e.mapperService.itemSizeToSalesItemDTO(o,e.item,n.items.find(a=>a.id===o.id))))})()}cancel(){return this.modalCtrl.dismiss()}confirm(){return this.modalCtrl.dismiss({cart:this.cart})}addItem(e){var n=this;return(0,l.Z)(function*(){n.cart=yield n.cartService.addToCart(e,n.cart),console.log(n.cart)})()}removeItem(e){var n=this;return(0,l.Z)(function*(){const o=yield n.cartService.getGeneralCart();n.cart=yield n.cartService.removeToCart(e,o),console.log(n.cart)})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.IN),t.Y36(I),t.Y36(d.N))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-sizes"]],inputs:{item:"item"},standalone:!0,features:[t.jDz],decls:12,vars:3,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],["class","flex justify-center",4,"ngIf"],[3,"disabled","click"],[1,"flex","justify-center"],[3,"click"],["name","remove"],["name","add","slot","icon-only"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return n.cancel()}),t._uU(4,"Cancel"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",2)(8,"ion-button",3),t.NdJ("click",function(){return n.confirm()}),t._uU(9,"Confirm"),t.qZA()()()(),t.TgZ(10,"ion-content",4),t.YNc(11,x,5,3,"ion-item",5),t.qZA()),2&e&&(t.xp6(6),t.Oqu(n.item.name),t.xp6(2),t.Q6J("strong",!0),t.xp6(3),t.Q6J("ngForOf",n.sizeItems))},dependencies:[r.Pc,r.YG,r.Sm,r.W2,r.Gu,r.gu,r.Ie,r.Q$,r.wd,r.sr,u.ez,u.sg,u.O5]}),i})();var T=s(1848),A=s(849),z=s(2953);function k(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-card-footer")(1,"ion-buttons",8)(2,"ion-button",9),t.NdJ("click",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.remove(o))}),t._UZ(3,"ion-icon",10),t.qZA(),t.TgZ(4,"ion-button",11),t.NdJ("click",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.add(o))}),t._UZ(5,"ion-icon",12),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.item.quantity<=0)}}const h=function(i){return[i]},y=function(i){return{item:i}};function M(i,c){if(1&i&&(t.TgZ(0,"ion-card-header")(1,"ion-button",1),t._uU(2,"Modificar"),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(2,h,e.item.id))("state",t.VKq(4,y,e.item))}}function J(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.addItem())}),t._uU(1,"A\xf1adir"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",!e.salesItem.quantity)}}function O(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.addItem())}),t._uU(1,"Modificar"),t.qZA()}}function N(i,c){if(1&i&&(t.TgZ(0,"ion-card-header"),t.YNc(1,J,2,1,"ion-button",13),t.YNc(2,O,2,0,"ion-button",14),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!(null!=e.salesItem&&e.salesItem.isAdded)),t.xp6(1),t.Q6J("ngIf",null==e.salesItem?null:e.salesItem.isAdded)}}function U(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-card-header")(1,"ion-buttons",17)(2,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.remove())}),t._UZ(3,"ion-icon",10),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.TgZ(6,"ion-button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.add())}),t._UZ(7,"ion-icon",12),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.salesItem.quantityAdded<=0),t.xp6(3),t.Oqu(e.salesItem.quantityAdded),t.xp6(1),t.Q6J("disabled",e.salesItem.quantityAdded>=e.salesItem.quantity)}}let F=(()=>{class i{constructor(e,n,o,a,p,_){this.router=e,this.mapperService=n,this.modalController=o,this.cartService=a,this.storage=p,this.itemService=_,this.addToCart=new t.vpe,this.removeToCart=new t.vpe}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(!e.salesItem){var n;e.salesItem=e.mapperService.itemDTOToSalesItemDTO(e.item);const a=(yield e.cartService.getGeneralCart()).items.find(p=>p.id===e.item.id||p.idFather===e.item.id);e.salesItem=e.mapperService.itemDTOToSalesItemDTO(e.item,a),null!==(n=e.item.sizes)&&void 0!==n&&n.length&&(e.salesItem.idFather=e.item.id)}})()}addItem(){var e=this;return(0,l.Z)(function*(){if(e.item.sizes){const n=yield e.modalController.create({component:q,componentProps:{item:e.item}});n.present(),n.onWillDismiss().then(function(){var o=(0,l.Z)(function*(a){if(a.data){const p=yield e.storage.get(T.WZ),_=yield e.cartService.initCart();a.data.cart.items.forEach(m=>{_.items.push(m)}),p.items.forEach(m=>{a.data.cart.items.find(D=>D.id===m.id)||_.items.push(m)});const Y=_.items.map(m=>m.price*m.quantityAdded);_.total=Y.reduce((m,Z)=>m+Z),yield e.storage.set(T.WZ,_),e.salesItem.isAdded=_.items.some(m=>m.idFather===e.salesItem.id)}});return function(a){return o.apply(this,arguments)}}())}else e.salesItem=e.mapperService.itemDTOToSalesItemDTO(e.item),e.salesItem.isAdded=!0,e.salesItem.quantity=1,--e.item.quantity,e.addToCart.emit({salesItem:e.salesItem,item:e.item})})()}add(e){var n=this;return(0,l.Z)(function*(){if(n.editMode)++n.item.quantity,n.itemService.modifyItem(n.item);else{let o=yield n.cartService.getGeneralCart();o=n.cartService.addToCart(n.salesItem,o),yield n.cartService.updateGeneralCart(o)}})()}remove(e){var n=this;return(0,l.Z)(function*(){if(n.editMode)--n.item.quantity,n.itemService.modifyItem(n.item);else{let o=yield n.cartService.getGeneralCart();o=n.cartService.removeToCart(n.salesItem,o),yield n.cartService.updateGeneralCart(o)}})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.F0),t.Y36(I),t.Y36(r.IN),t.Y36(d.N),t.Y36(A.K),t.Y36(z.e))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-item-card"]],inputs:{item:"item",size:"size",editMode:"editMode"},outputs:{addToCart:"addToCart",removeToCart:"removeToCart"},standalone:!0,features:[t.jDz],decls:17,vars:14,consts:[[1,"h-64","flex","flex-col","justify-between"],[3,"routerLink","state"],[3,"src"],[1,"bullet","br","bg-green-500"],[1,"text-black"],[1,"bullet","bl","bg-red-500"],[1,"text-white"],[4,"ngIf"],[1,"flex","justify-center","text-center","mb-6"],["size","large",3,"disabled","click"],["name","remove"],["size","large",3,"click"],["name","add"],[3,"disabled","click",4,"ngIf"],[3,"click",4,"ngIf"],[3,"disabled","click"],[3,"click"],[1,"flex","justify-center","text-center","mb-2"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-card",0)(1,"div",1)(2,"ion-card-header")(3,"span"),t._uU(4),t.qZA()(),t.TgZ(5,"ion-card-content"),t._UZ(6,"ion-img",2),t.TgZ(7,"div",3)(8,"span",4),t._uU(9),t.qZA()(),t.TgZ(10,"div",5)(11,"span",6),t._uU(12),t.qZA()()()(),t.YNc(13,k,6,1,"ion-card-footer",7),t.YNc(14,M,3,6,"ion-card-header",7),t.YNc(15,N,3,2,"ion-card-header",7),t.YNc(16,U,8,3,"ion-card-header",7),t.qZA()),2&e&&(t.xp6(1),t.Q6J("routerLink",n.router.url.includes("inventory")?t.VKq(10,h,n.item.id):n.router.url)("state",t.VKq(12,y,n.item)),t.xp6(3),t.Oqu(n.item.name),t.xp6(2),t.Q6J("src",n.item.img),t.xp6(3),t.hij("",n.item.price,"\u20ac"),t.xp6(3),t.Oqu(n.item.quantity),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("inventory")&&n.editMode&&!n.salesItem.idFather),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("inventory")&&n.editMode&&(null==n.salesItem?null:n.salesItem.idFather)),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("sales")&&(null==n.salesItem?null:n.salesItem.idFather)),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("sales")&&!(null!=n.salesItem&&n.salesItem.idFather)))},dependencies:[f.rH,r.Pc,r.YG,r.Sm,r.PM,r.FN,r.Zi,r.gu,r.Xz,r.wd,r.YI,u.ez,u.O5,C.UX]}),i})()},2953:(S,v,s)=>{s.d(v,{e:()=>f});var l=s(9808),u=s(2340),t=s(8256),C=s(529);let f=(()=>{class r{constructor(d){this.httpClient=d}getItemsStore(d){return(0,l.n)(this.httpClient.get(`${u.N.urlServer}/items/store/${d}`))}createItemStore(d,g){return(0,l.n)(this.httpClient.post(`${u.N.urlServer}/items/store/${d}`,g))}modifyItem(d){return(0,l.n)(this.httpClient.put(`${u.N.urlServer}/items/${d.id}`,{data:d}))}}return r.\u0275fac=function(d){return new(d||r)(t.LFG(C.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);