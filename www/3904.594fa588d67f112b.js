"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3904],{3904:(I,f,s)=>{s.r(f),s.d(f,{HomePage:()=>A});var c=s(5861),u=s(6895),a=s(433),n=s(6114),p=s(9993),e=s(8256),h=s(2e3),m=s(7556);function S(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-button",4),e.NdJ("click",function(){const d=e.CHM(t).$implicit,g=e.oxw();return e.KtG(g.joinStore(d))}),e._uU(4),e.qZA()()}if(2&i){const t=l.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.isJoined?"Quitar":"Unirse")}}let C=(()=>{class i{constructor(t,o,r){this.modalCtrl=t,this.storeService=o,this.authService=r}ngOnInit(){var t=this;return(0,c.Z)(function*(){t.stores=yield t.storeService.getStoresJoined()})()}cancel(){return this.modalCtrl.dismiss()}joinStore(t){return this.modalCtrl.dismiss(t)}isJoined(t){var o=this;return(0,c.Z)(function*(){const r=yield o.authService.getToken();console.log(r.user)})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(n.IN),e.Y36(h.d),e.Y36(m.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-join"]],standalone:!0,features:[e.jDz],decls:9,vars:1,consts:[["slot","start"],["color","medium",3,"click"],[1,"ion-padding"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return o.cancel()}),e._uU(4,"Cerrar"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Unete a una tienda"),e.qZA()()(),e.TgZ(7,"ion-content",2),e.YNc(8,S,5,2,"ion-item",3),e.qZA()),2&t&&(e.xp6(8),e.Q6J("ngForOf",o.stores))},dependencies:[n.Pc,n.YG,n.Sm,n.W2,n.Gu,n.Ie,n.Q$,n.wd,n.sr,u.ez,u.sg]}),i})();var v=s(6388);function Z(i,l){if(1&i&&e._UZ(0,"ion-img",8),2&i){const t=e.oxw();let o;e.Q6J("src",null==(o=t.storeForm.get("img"))?null:o.value)}}let y=(()=>{class i{constructor(t,o,r){this.modalCtrl=t,this.formBuilder=o,this.authService=r,this.storeForm=this.formBuilder.group({name:"",img:"",users:[]})}ngOnInit(){var t=this;return(0,c.Z)(function*(){t.storeForm=t.formBuilder.group({name:["",a.kI.required],img:["",a.kI.required],users:[(yield t.authService.getToken()).user.id,a.kI.required]})})()}cancel(){this.modalCtrl.dismiss()}confirm(){this.modalCtrl.dismiss(this.storeForm.value)}uploadPhoto(){var t=this;return(0,c.Z)(function*(){const o=yield v.V1.getPhoto({resultType:v.dk.Base64,quality:100});t.storeForm.patchValue({img:`data:image/${o.format};base64,${o.base64String}`})})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(n.IN),e.Y36(a.qu),e.Y36(m.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-create"]],standalone:!0,features:[e.jDz],decls:15,vars:4,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"disabled","strong","click"],[1,"ion-padding",3,"formGroup"],["formControlName","name","mode","md","label","Nombre","labelPlacement","floating","clearInput","true","fill","outline","placeholder","Nombre de la tienda","color","primary","shape","round"],[3,"click"],[3,"src",4,"ngIf"],[3,"src"]],template:function(t,o){if(1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return o.cancel()}),e._uU(4,"Cerrar"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Crear una tienda"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return o.confirm()}),e._uU(9,"Confirmar"),e.qZA()()()(),e.TgZ(10,"ion-content",4),e._UZ(11,"ion-input",5),e.TgZ(12,"ion-button",6),e.NdJ("click",function(){return o.uploadPhoto()}),e._uU(13,"Subir foto"),e.qZA(),e.YNc(14,Z,1,1,"ion-img",7),e.qZA()),2&t){let r;e.xp6(8),e.Q6J("disabled",o.storeForm.invalid)("strong",!0),e.xp6(2),e.Q6J("formGroup",o.storeForm),e.xp6(4),e.Q6J("ngIf",null==o.storeForm||null==(r=o.storeForm.get("img"))?null:r.value)}},dependencies:[n.Pc,n.YG,n.Sm,n.W2,n.Gu,n.Xz,n.pK,n.wd,n.sr,n.j9,u.ez,u.O5,a.UX,a.JJ,a.JL,a.sg,a.u]}),i})();var _=s(1848),T=s(849),J=s(8270),b=s(501);const k=function(i){return["/tabs",i,"sales"]};function F(i,l){if(1&i&&(e.TgZ(0,"ion-item")(1,"div",5)(2,"ion-label"),e._uU(3),e.qZA(),e.TgZ(4,"ion-avatar"),e._UZ(5,"ion-img",6),e.qZA()()()),2&i){const t=l.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(3,k,t.id)),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("src",t.img)}}function Y(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"ion-footer",7)(1,"ion-button",8),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.createStore())}),e._uU(2,"Crear"),e.qZA(),e.TgZ(3,"ion-button",8),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.joinStore())}),e._uU(4,"Unirse"),e.qZA()()}}let A=(()=>{class i{constructor(t,o,r,d,g,P,U){this.storeService=t,this.modalController=o,this.storage=r,this.navController=d,this.utilsService=g,this.configService=P,this.authService=U,this.ROLES=_.K$,this.isRole=!1}ngOnInit(){var t=this;return(0,c.Z)(function*(){const o=yield t.utilsService.showLoading();t.isRole=yield t.authService.isRole(_.K$.ADMIN),yield t.loadPage(),o.dismiss()})()}loadPage(){var t=this;return(0,c.Z)(function*(){t.stores=yield t.storeService.getStoresByMe();const o=(yield t.configService.getConfigServiceByKey("idApp")).data;console.log(o),o.length>0&&(++o[0].attributes.value,yield t.configService.updateConfigService(o[0].attributes,o[0].id))})()}createStore(){var t=this;return(0,c.Z)(function*(){const o=yield t.modalController.create({component:y});yield o.present();const r=(yield o.onDidDismiss()).data;r&&(yield t.storeService.createStore(r),yield t.loadPage())})()}joinStore(){var t=this;return(0,c.Z)(function*(){const o=yield t.modalController.create({component:C});yield o.present();const r=(yield o.onDidDismiss()).data;r&&(r.isJoined?yield t.storeService.separateJoin(r.id):yield t.storeService.joinStore(r.id),t.stores=yield t.storeService.getStoresByMe())})()}logout(){var t=this;return(0,c.Z)(function*(){yield t.storage.clear(),t.navController.navigateRoot(["/login"])})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.d),e.Y36(n.IN),e.Y36(T.K),e.Y36(n.SH),e.Y36(J.F),e.Y36(b.y),e.Y36(m.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-home"]],standalone:!0,features:[e.jDz],decls:11,vars:4,consts:[[3,"translucent"],["src","./../../../assets/icon/scrumstock-icon.png","slot","end",1,"h-12","mr-5",3,"click"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["class","flex justify-between",4,"ngIf"],[3,"routerLink"],[3,"src"],[1,"flex","justify-between"],["shape","round","expand","block",1,"w-full",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Inicio"),e.qZA(),e.TgZ(4,"ion-img",1),e.NdJ("click",function(){return o.logout()}),e.qZA()()(),e.TgZ(5,"ion-content",2)(6,"ion-title"),e._uU(7,"Tiendas asociadas"),e.qZA(),e.TgZ(8,"ion-list"),e.YNc(9,F,6,5,"ion-item",3),e.qZA()(),e.YNc(10,Y,5,0,"ion-footer",4)),2&t&&(e.Q6J("translucent",!0),e.xp6(5),e.Q6J("fullscreen",!0),e.xp6(4),e.Q6J("ngForOf",o.stores),e.xp6(1),e.Q6J("ngIf",o.isRole))},dependencies:[n.Pc,n.BJ,n.YG,n.W2,n.fr,n.Gu,n.Xz,n.Ie,n.Q$,n.q_,n.wd,n.sr,n.YI,u.ez,u.sg,u.O5,a.u5,p.Bz,p.rH]}),i})()}}]);