"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3315],{3315:(A,Z,s)=>{s.d(Z,{E:()=>w});var l=s(5861),m=s(6895),t=s(8256),S=s(433),u=s(9993),r=s(6114);let v=(()=>{class o{constructor(){}itemDTOToSalesItemDTO(e,n){var i;return{id:e.id,name:e.name,quantity:e.quantity,quantityAdded:null!==(i=null==n?void 0:n.quantityAdded)&&void 0!==i?i:0,isAdded:!!n,price:e.price}}itemSizeToSalesItemDTO(e,n,i){var a;return{id:e.id,name:n.name,quantity:e.quantity,quantityAdded:null!==(a=null==i?void 0:i.quantityAdded)&&void 0!==a?a:0,isAdded:!!i,price:n.price,size:e.name,idFather:n.id}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var d=s(910);function h(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addItem(i))}),t._uU(1,"A\xf1adir"),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.Q6J("disabled",!e.quantity||e.quantityAdded>e.quantity)}}function b(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"ion-buttons",9)(1,"ion-button",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.removeItem(i))}),t._UZ(2,"ion-icon",11),t.qZA(),t.TgZ(3,"ion-label"),t._uU(4),t.qZA(),t.TgZ(5,"ion-button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addItem(i))}),t._UZ(6,"ion-icon",12),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.quantityAdded),t.xp6(1),t.Q6J("disabled",e.quantityAdded>=e.quantity)}}function x(o,c){if(1&o&&(t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.qZA(),t.YNc(3,h,2,1,"ion-button",6),t.YNc(4,b,7,2,"ion-buttons",7),t.qZA()),2&o){const e=c.$implicit;t.xp6(2),t.Oqu(e.size),t.xp6(1),t.Q6J("ngIf",!e.quantityAdded),t.xp6(1),t.Q6J("ngIf",null==e?null:e.quantityAdded)}}let g=(()=>{class o{constructor(e,n,i){this.modalCtrl=e,this.mapperService=n,this.cartService=i,this.sizeItems=[]}ngOnInit(){this.loadModal()}loadModal(){var e=this;return(0,l.Z)(function*(){e.cart=yield e.cartService.initCart();const n=yield e.cartService.getGeneralCart();e.item.sizes&&(e.sizeItems=e.item.sizes.map(i=>e.mapperService.itemSizeToSalesItemDTO(i,e.item,n.items.find(a=>a.id===i.id))))})()}cancel(){return this.modalCtrl.dismiss()}confirm(){return this.modalCtrl.dismiss({cart:this.cart})}addItem(e){var n=this;return(0,l.Z)(function*(){n.cart=yield n.cartService.addToCart(e,n.cart),console.log(n.cart)})()}removeItem(e){var n=this;return(0,l.Z)(function*(){const i=yield n.cartService.getGeneralCart();n.cart=yield n.cartService.removeToCart(e,i),console.log(n.cart)})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.IN),t.Y36(v),t.Y36(d.N))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sizes"]],inputs:{item:"item"},standalone:!0,features:[t.jDz],decls:12,vars:3,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],["class","flex justify-center",4,"ngIf"],[3,"disabled","click"],[1,"flex","justify-center"],[3,"click"],["name","remove"],["name","add","slot","icon-only"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.NdJ("click",function(){return n.cancel()}),t._uU(4,"Cancel"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",2)(8,"ion-button",3),t.NdJ("click",function(){return n.confirm()}),t._uU(9,"Confirm"),t.qZA()()()(),t.TgZ(10,"ion-content",4),t.YNc(11,x,5,3,"ion-item",5),t.qZA()),2&e&&(t.xp6(6),t.Oqu(n.item.name),t.xp6(2),t.Q6J("strong",!0),t.xp6(3),t.Q6J("ngForOf",n.sizeItems))},dependencies:[r.Pc,r.YG,r.Sm,r.W2,r.Gu,r.gu,r.Ie,r.Q$,r.wd,r.sr,m.ez,m.sg,m.O5]}),o})();var T=s(1848),I=s(849),C=s(2953),f=s(1957);function M(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"ion-card-footer")(1,"ion-buttons",7)(2,"ion-button",8),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.remove(i))}),t._UZ(3,"ion-icon",9),t.qZA(),t.TgZ(4,"ion-button",10),t.NdJ("click",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.add(i))}),t._UZ(5,"ion-icon",11),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.item.quantity<=0)}}const z=function(o){return[o]},O=function(o){return{item:o}};function J(o,c){if(1&o&&(t.TgZ(0,"ion-card-header")(1,"ion-button",12),t._uU(2,"Modificar"),t.qZA()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(2,z,e.item.id))("state",t.VKq(4,O,e.item))}}function U(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addItem())}),t._uU(1,"A\xf1adir"),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",!e.salesItem.quantity)}}function E(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addItem())}),t._uU(1,"Modificar"),t.qZA()}}function N(o,c){if(1&o&&(t.TgZ(0,"ion-card-header"),t.YNc(1,U,2,1,"ion-button",13),t.YNc(2,E,2,0,"ion-button",14),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!(null!=e.salesItem&&e.salesItem.isAdded)),t.xp6(1),t.Q6J("ngIf",null==e.salesItem?null:e.salesItem.isAdded)}}function D(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"ion-card-header")(1,"ion-buttons",17)(2,"ion-button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.remove())}),t._UZ(3,"ion-icon",9),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA(),t.TgZ(6,"ion-button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.add())}),t._UZ(7,"ion-icon",11),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.salesItem.quantityAdded<=0),t.xp6(3),t.Oqu(e.salesItem.quantityAdded),t.xp6(1),t.Q6J("disabled",e.salesItem.quantityAdded>=e.salesItem.quantity)}}let w=(()=>{class o{constructor(e,n,i,a,y,_,q){this.router=e,this.mapperService=n,this.modalController=i,this.cartService=a,this.storage=y,this.itemService=_,this.photoService=q,this.addToCart=new t.vpe,this.removeToCart=new t.vpe}ngOnInit(){var e=this;return(0,l.Z)(function*(){if(!e.salesItem){var n,i;e.salesItem=e.mapperService.itemDTOToSalesItemDTO(e.item);const y=null===(n=(yield e.cartService.getGeneralCart()).items)||void 0===n?void 0:n.find(_=>_.id===e.item.id||_.idFather===e.item.id);e.salesItem=e.mapperService.itemDTOToSalesItemDTO(e.item,y),null!==(i=e.item.sizes)&&void 0!==i&&i.length&&(e.salesItem.idFather=e.item.id)}})()}addItem(){var e=this;return(0,l.Z)(function*(){if(e.item.sizes){const n=yield e.modalController.create({component:g,componentProps:{item:e.item}});n.present(),n.onWillDismiss().then(function(){var i=(0,l.Z)(function*(a){if(a.data){const y=yield e.storage.get(T.WZ),_=yield e.cartService.initCart();a.data.cart.items.forEach(p=>{_.items.push(p)}),y.items.forEach(p=>{a.data.cart.items.find(Y=>Y.id===p.id)||_.items.push(p)});const q=_.items.map(p=>p.price*p.quantityAdded);_.total=q.reduce((p,k)=>p+k),yield e.storage.set(T.WZ,_),e.salesItem.isAdded=_.items.some(p=>p.id===e.salesItem.id)}});return function(a){return i.apply(this,arguments)}}())}else e.salesItem=e.mapperService.itemDTOToSalesItemDTO(e.item),e.salesItem.isAdded=!0,e.salesItem.quantity=1,--e.item.quantity,e.addToCart.emit({salesItem:e.salesItem,item:e.item})})()}add(e){var n=this;return(0,l.Z)(function*(){if(n.editMode)e.preventDefault(),++n.item.quantity,n.itemService.modifyItem(n.item);else{let i=yield n.cartService.getGeneralCart();i=n.cartService.addToCart(n.salesItem,i),yield n.cartService.updateGeneralCart(i)}})()}remove(e){var n=this;return(0,l.Z)(function*(){if(n.editMode)--n.item.quantity,n.itemService.modifyItem(n.item);else{let i=yield n.cartService.getGeneralCart();i=n.cartService.removeToCart(n.salesItem,i),yield n.cartService.updateGeneralCart(i)}})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(u.F0),t.Y36(v),t.Y36(r.IN),t.Y36(d.N),t.Y36(I.K),t.Y36(C.e),t.Y36(f.T))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-item-card"]],inputs:{item:"item",size:"size",editMode:"editMode"},outputs:{addToCart:"addToCart",removeToCart:"removeToCart"},standalone:!0,features:[t.jDz],decls:17,vars:14,consts:[[1,"h-64","flex","flex-col","justify-between",3,"routerLink","state"],[3,"src"],[1,"bullet","br","bg-green-500"],[1,"text-black"],[1,"bullet","bl","bg-red-500"],[1,"text-white"],[4,"ngIf"],[1,"flex","justify-center","text-center","mb-6"],["size","large",3,"disabled","click"],["name","remove"],["size","large",3,"click"],["name","add"],[3,"routerLink","state"],[3,"disabled","click",4,"ngIf"],[3,"click",4,"ngIf"],[3,"disabled","click"],[3,"click"],[1,"flex","justify-center","text-center","mb-2"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-card",0)(1,"div")(2,"ion-card-header")(3,"span"),t._uU(4),t.qZA()(),t.TgZ(5,"ion-card-content"),t._UZ(6,"ion-img",1),t.TgZ(7,"div",2)(8,"span",3),t._uU(9),t.qZA()(),t.TgZ(10,"div",4)(11,"span",5),t._uU(12),t.qZA()()()(),t.YNc(13,M,6,1,"ion-card-footer",6),t.YNc(14,J,3,6,"ion-card-header",6),t.YNc(15,N,3,2,"ion-card-header",6),t.YNc(16,D,8,3,"ion-card-header",6),t.qZA()),2&e&&(t.Q6J("routerLink",n.router.url.includes("inventory")?t.VKq(10,z,n.item.id):n.router.url)("state",t.VKq(12,O,n.item)),t.xp6(4),t.Oqu(n.item.name),t.xp6(2),t.Q6J("src",n.item.img),t.xp6(3),t.hij("",n.item.price,"\u20ac"),t.xp6(3),t.Oqu(n.item.quantity),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("inventory")&&n.editMode&&!n.salesItem.idFather),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("inventory")&&n.editMode&&(null==n.salesItem?null:n.salesItem.idFather)),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("sales")&&(null==n.salesItem?null:n.salesItem.idFather)),t.xp6(1),t.Q6J("ngIf",n.router.url.includes("sales")&&!(null!=n.salesItem&&n.salesItem.idFather)))},dependencies:[u.rH,r.Pc,r.YG,r.Sm,r.PM,r.FN,r.Zi,r.gu,r.Xz,r.wd,r.YI,m.ez,m.O5,S.UX]}),o})()},2953:(A,Z,s)=>{s.d(Z,{e:()=>u});var l=s(9808),m=s(2340),t=s(8256),S=s(529);let u=(()=>{class r{constructor(d){this.httpClient=d}getItemsStore(d){return(0,l.n)(this.httpClient.get(`${m.N.urlServer}/items/store/${d}`))}createItemStore(d,h){return(0,l.n)(this.httpClient.post(`${m.N.urlServer}/items/store/${d}`,h))}modifyItem(d){return(0,l.n)(this.httpClient.put(`${m.N.urlServer}/items/${d.id}`,{data:d}))}}return r.\u0275fac=function(d){return new(d||r)(t.LFG(S.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},1957:(A,Z,s)=>{s.d(Z,{T:()=>S});var l=s(5861),m=s(6388),t=s(8256);let S=(()=>{class u{constructor(){}compressBase64(v,d=1,h=700,b=700){return new Promise(x=>{const g=new Image;g.src=`data:image/jpeg;base64,${v}`,g.onload=()=>{var T;let I=g.width,C=g.height;const f=document.createElement("canvas");I>C?I>h&&(C*=h/I,I=h):C>b&&(I*=b/C,C=b),f.width=I,f.height=C,null==f||null===(T=f.getContext("2d"))||void 0===T||T.drawImage(g,0,0,f.width,f.height),x(f.toDataURL("image/jpeg",d))}})}takePhoto(){return(0,l.Z)(function*(){return yield m.V1.getPhoto({resultType:m.dk.Base64,quality:100,width:500,height:500})})()}}return u.\u0275fac=function(v){return new(v||u)},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);