"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3058],{3058:(L,d,a)=>{a.r(d),a.d(d,{LoginPage:()=>h});var c=a(5861),_=a(6895),o=a(433),r=a(6114),e=a(8256),m=a(7556),p=a(849);function v(s,g){1&s&&(e.TgZ(0,"ion-item",7)(1,"ion-label",8),e._uU(2,"Usuario"),e.qZA(),e._UZ(3,"ion-input",14),e.qZA())}function f(s,g){1&s&&e._UZ(0,"ion-spinner",15)}let h=(()=>{class s{constructor(n,i,t,l){this.formBuilder=n,this.authService=i,this.storage=t,this.navController=l,this.loginForm=this.formBuilder.group({username:["John",[o.kI.required,o.kI.minLength(3)]],password:["",[o.kI.required,o.kI.minLength(6)]],email:["",[o.kI.email]]}),this.isLoading=!1,this.registerMode=!1}ngOnInit(){}login(){var n=this;return(0,c.Z)(function*(){var i,t;n.isLoading=!0;const l={identifier:null===(i=n.loginForm.get("email"))||void 0===i?void 0:i.value,password:null===(t=n.loginForm.get("password"))||void 0===t?void 0:t.value};try{const u=yield n.authService.login(l);console.log(u),yield n.storage.set("token",u);const P=yield n.authService.getMe();u.user=P,yield n.storage.set("token",u),n.navController.navigateForward("/home")}catch{n.isLoading=!1}n.isLoading=!1})()}register(){var n=this;return(0,c.Z)(function*(){if(n.registerMode){var i,t,l;const u={email:null===(i=n.loginForm.get("email"))||void 0===i?void 0:i.value,password:null===(t=n.loginForm.get("password"))||void 0===t?void 0:t.value,username:null===(l=n.loginForm.get("username"))||void 0===l?void 0:l.value,role:{connect:[{id:3,position:{end:!0}}],disconnect:[]},confirmed:!0,blocked:!1};yield n.authService.register(u),yield n.login()}else n.registerMode=!0,n.loginForm.patchValue({username:""});console.log("register")})()}}return s.\u0275fac=function(n){return new(n||s)(e.Y36(o.qu),e.Y36(m.e),e.Y36(p.K),e.Y36(r.SH))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-login"]],standalone:!0,features:[e.jDz],decls:21,vars:5,consts:[[1,"ion-padding"],[1,"login-container"],[1,"ion-justify-content-center"],[2,"text-align","center"],["src","../../../assets/icon/ScrumStock.svg",1,""],[3,"formGroup"],["class","item","lines","none",4,"ngIf"],["lines","none",1,"item"],["position","stacked"],["type","mail","formControlName","email"],["type","password","formControlName","password"],[1,"center"],["type","submit","shape","round",1,"btn-grad",3,"disabled","click"],["name","circular",4,"ngIf"],["type","text","formControlName","username"],["name","circular"]],template:function(n,i){1&n&&(e.TgZ(0,"ion-content",0)(1,"ion-grid",1)(2,"ion-row",2)(3,"ion-col",3),e._UZ(4,"img",4),e.TgZ(5,"form",5),e.YNc(6,v,4,0,"ion-item",6),e.TgZ(7,"ion-item",7)(8,"ion-label",8),e._uU(9,"Email"),e.qZA(),e._UZ(10,"ion-input",9),e.qZA(),e.TgZ(11,"ion-item",7)(12,"ion-label",8),e._uU(13,"Contrase\xf1a"),e.qZA(),e._UZ(14,"ion-input",10),e.qZA(),e.TgZ(15,"div",11)(16,"ion-button",12),e.NdJ("click",function(){return i.login()}),e._uU(17," Entrar "),e.YNc(18,f,1,0,"ion-spinner",13),e.qZA(),e.TgZ(19,"ion-button",12),e.NdJ("click",function(){return i.register()}),e._uU(20," Registrarse "),e.qZA()()()()()()()),2&n&&(e.xp6(5),e.Q6J("formGroup",i.loginForm),e.xp6(1),e.Q6J("ngIf",i.registerMode),e.xp6(10),e.Q6J("disabled",i.loginForm.invalid),e.xp6(2),e.Q6J("ngIf",i.isLoading),e.xp6(1),e.Q6J("disabled",i.loginForm.invalid))},dependencies:[r.Pc,r.YG,r.wI,r.W2,r.jY,r.pK,r.Ie,r.Q$,r.Nd,r.PQ,r.j9,_.ez,_.O5,o.u5,o._Y,o.JJ,o.JL,o.UX,o.sg,o.u]}),s})()}}]);